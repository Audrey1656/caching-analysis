library(data.table)
library(ggplot2)

dt <- data.table(read.csv("first.table"))


officialports <- c(1,5,7,9,11,13,17,18,19,20,21,22,23,25,37,42,43,47,49,51,52,53,54,56,58,61,67,68,69,70,71:74,79,80,88,101,102,104,105,107,108,109,110,111,113,115,117,118,119,123,126,135,137,138,139,143,152,153,156,158,161,162,170,177,179,194,201,209,210,213,218,220,225:241,249:255,259,262,264,280,308,311,318,319,320,350,351,356,366,369,370,371,383,384,387,388,389,399,401,427,433,434,443,444,445,464,465,475,497,500,502,504,510,512,513,514,515,517,518,520,521,524,525,530,532,533,540,542,543,544,546,547,548,550,554,556,560,561,563,587,591,593,601,604,623,631,635,636,639,641,643,646,647,648,651,653,654,655,657,660,666,674,688,690,691,694,695,698,700,701,702,706,711,712,749,750,753,754,800,829,830,831,832,833,847,848,853,860,861,862,873,953,989,990,991,992,993,994,995,1011:1020,1023)

dt[,pport:=ifelse(portdst %in% officialports,portdst,
                  ifelse(portsrc %in% officialports,portsrc,"uo"))]



ggplot(dt,aes(pport,packets))+
    geom_point()

ggplot(dt[pport<2000],aes(pport,packets))+
    geom_point()


ggplot(dt,aes(portsrc,packets))+
    geom_point()

ggplot(dt,aes(portdst,packets))+
    geom_point()

